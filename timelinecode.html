<!DOCTYPE html>
    <html>
    	<head>
    		<title>My experiment</title>
    		<script src="jsPsych/jspsych.js"></script>
    		<script src="jsPsych/plugins/jspsych-html-keyboard-response.js"></script>
            <script src="jsPsych/plugins/jspsych-image-keyboard-response.js"></script>
            <script src="jsPsych/plugins/jspsych-blurry-word.js"></script>
    		<link href="jsPsych/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    	</head>
    	<body></body>
    	<script>
            // prepare trial parameters
            var w_choices = ['been', 'book', 'cash', 'dead', 'from', 'long',
                'look', 'luck', 'much', 'neck', 'room', 'seem', 'send', 'test',
                'want'];
            // randomly select four words from the bank
            var words = [w_choices[Math.floor(Math.random() * w_choices.length)],
                w_choices[Math.floor(Math.random() * w_choices.length)],
                w_choices[Math.floor(Math.random() * w_choices.length)],
                w_choices[Math.floor(Math.random() * w_choices.length)]]
            var m_choices = [1, 2];
            // randomly select one of the two sets of scrambled words
            const meaningless = m_choices[Math.floor(Math.random() * 2)]
            var test_m = [0, meaningless];
            var target_m = [0, meaningless];
            var blur = [3, 4, 6, 7];

            var trial_types = [];
            for (const i of words) {
                for (const j of test_m) {
                    for (const k of target_m) {
                        for (const l of blur) {
                            trial_types.push([i, j, k, l])
                        }
                    }
                }
            }
            console.log(trial_types)

            var timeline_variables = [];
            for (const i of trial_types) {
                word = i[0]
                target = word.concat(i[2], '.png')
                test = word.concat(i[1], '.png')
                blur = i[3]
                timeline_variables.push({
                    target_stimulus: target, test_stimulus: test,
                    targetBlur : blur
                })
            }

            var timeline = [];

            // // screen between trials
            // var break_screen = {
            //     type: 'html-keyboard-response',
            //     stimulus:
            // }
            //
            // // practice trials
            // var probe_instructions = {
            //
            //
            // }
            //
            // var probe_practice = {
            //     type: 'jspsych-blurry-word'
            // }
            //
            // var blur_instructions = {
            //
            // }
            //
            // var blur_practice = {
            //     type: 'jspsych-blurry-word'
            // }
            //
            // var task_instructions = {
            //
            // }
            //
            // var task_practice = {
            //     type: 'jspsych-blurry-word'
            // }
            //
            // var practice_block = {
            // // here, we will ensure that the order in which participants undergo
            // //     practice is randomized
            // // result should be a list containing (1) first phase instructions
            // //     (2) first phase trials, repeated as desired (3) second phase
            // //     instructions (4) second phase trials, repeated as desired
            // //     (5) third phase instructions (6) third phase trials, repeated as
            // //     desired
            //
            // }
            // timeline.push(practice_block);

            var trial = {
                type: 'jspsych-blurry-word',
                target_stimulus: jsPsych.timelineVariable('target_stimulus'),
                test_stimulus: jsPsych.timelineVariable('test_stimulus'),
                targetBlur: jsPsych.timelineVariable('targetBlur')
            }

            var all_trials = {
                timeline: [trial],
                timeline_variables: timeline_variables,
                randomize_order: true,
                repetitions: 1
            }
            timeline.push(all_trials);

            jsPsych.init({
              timeline: timeline,
            });
        </script>
    </html>
